## 什么是进程

进程是系统进行资源分配的基本单位，是程序加载到内存后的执行过程。进程一般由数据段，代码段和进程控制块三部分组成。系统通过进程控制块感知进程的存在并对进程进行控制。由于**进程之间空间相互独立**，多进程比多线程更安全，一个进程基本上不会影响另外一个进程。

## 进程三种状态

1.  就绪
2.  运行
3.  阻塞

## 什么是线程

线程是CPU调度的基本单位。一个进程可以包含多个线程，线程自己基本不拥有系统资源，但是它可以和同属于一个进程的其他线程共享进程所拥有的全部资源。多线程之间堆内存共享，线程间通信可以直接基于共享内存来实现，比多进程之间通信更轻量。多线程之间切换**不需要切换虚拟内存空间、文件描述符**等，所以线程的上下文切换也比多进程轻量。

## 多进程和多线程的应用场景

一般不同任务间需要大量的通信，使用多线程的场景比多进程多。但是多进程有更高的容错性，一个进程的崩溃不会导致整个系统的崩溃，在任务安全性较高的情况下，采用多进程。

## 进程切换的开销

开销分成两种:

1.直接开销

2.间接开销

 ### 直接开销: 

1.  **切换页表全局目录**
2.  切换**内核态堆栈**
3.  切换硬件上下文：寄存器当中的数据
4.  刷新TLB
5.  执行操作系统调度器的代码

### 间接开销:

间接开销指的是由于切换到一个新进程后，各种缓存对于新的进程而言未命中的概率非常大。进程如果跨CPU调度，那么之前的TLB、L1、L2、L3缓存因为运行的进程已经变了，缓存所带来的空间局部性和时间局部性的优势失效，当前缓存起来的代码、数据失效。这将导致新进程需要重新从内存当中获取数据和代码，并将其缓存起来。从而导致穿透到内存的**IO**会变多，由于CPU和内存读取速度的差异很大，这部分带来的开销也非常大。

## 线程切换的开销

**线程切换和进程切换之间的主要区别在于**：

1.  在线程切换期间，虚拟内存空间保持不变。
2.  进程切换期间，TLB会被刷新，从而使内存访问在一段时间内变得更加昂贵。

 ## 进程线程的本质区别

1.进程**更安全**，一个进程完全不会影响另外的进程。

2.进程间通信比线程间**通信的性能差**很多。

3.线程切换开销更低。

## IPC进程间通信55555555555

1.  无名管道pipe（血缘关系的进程）
2.  有名管道fifo （无血缘关系的进程）
3.  共享内存
4.  信号(开销小)
5.  消息队列

## 进程间同步

1.  文件锁
2.  信号量

## 线程间同步

1.  互斥锁
2.  读写锁
3.  条件变量
4.  信号量(互斥锁的升级版)

## 线程共享资源

1.  文件描述符表（打开的文件）
2.  **进程用户ID和进程组ID**
3.  进程的**内存地址空间.**text代码段 .data数据段 .bss heap堆区 **全局变量 静态变量**
4.  每种信号的处理方式
5.  **进程的当前目录**

## 线程独享资源

1.  **线程栈**
2.  **寄存器组的值**
3.  线程ID
4.  错误返回码errno变量
5.  线程信号屏蔽字
6.  **线程优先级**

## 进程调度方式

1.  抢占式：立马停止。
2.  非抢占式：时间片用完或者等待资源时，再调用另一个进程。

## 进程调度算法

1.  先来先服务
2.  短作业优先
3.  优先级调度
4.  时间片轮转
5.  高响应比优先

## 管道

管道是一种伪文件，实质为内核缓冲区 大小为4K 内核借用环形队列实现

管道是半双工的，数据只能单向流动，不可重复读取，只能用于有血缘关系的进程

## Linux命令

1.  find命令，用来查找文件。常用的按照名字查找-name，按照文件类型查找-type，linux常用的文件类型有七种，普通文件，目录文件，管道，套接字，软链接，块设备，字符设备。还可以按照文件大小查询-size。
2.  grep命令，按照文件内容来查找。使用规则是grep option pattern file 
3.  ps aux
4.  curl命令 访问一个网页
5.  sed / awk
6.  **df查看磁盘大小**
7.  **du查看目录大小**
8.  free -h 查看内存大小和使用情况
9.  top查看系统的实时负载
10.  netstat -ta 查看监听的TCP
11.  fcntl 改变已经打开的文件的属性
12.  stat 获取文件属性

## 大端字节序和小端字节序

大端字节序：网络字节序（高位存低位） 小端字节序：主机字节序，现代PC机采用小端字节序（低位存低位，高位存高位） 比如0x1f3f5f7f 地址0x1000 0x1001 0x1002 0x1003 大端法：7f存在0x1003 5f存0x1002 3f存0x1001 1f存0x1000 低存高 小端法：7f存在0x1000 5f存0x1001 3f存0x1002 1f存0x1003 低存低

## socket服务器端所用函数

socket 创建socket文件描述符 bind 绑定IP和端口号 listen 监听 accept 接受连接 处理客户端的业务

## socket客户端所用函数

socket 创建套接字文件描述符 bind 绑定IP和端口号（也可以隐式绑定） connect 尝试连接服务器 处理服务器端的业务

## 五种网络IO模型

同步阻塞IO 同步非阻塞IO IO多路复用 信号驱动IO 异步IO

## select与poll、epoll的各自的优缺点和区别

select是跨平台的，windows、linux、unix系统下都有 poll在linux和unix下有 epoll是linux特有，epoll的要义就是高效的监视多个socket

## 讲讲epoll的边沿触发和水平触发

水平触发：如果epoll_wait缓冲区有数据则直接返回。 边沿触发：如果一次没有读完epoll_wait缓冲区中的数据，则只有当另外有数据再写入时，才返回。 使用边沿触发和非阻塞IO来达到水平触发的效果，减少了epoll_wait的调用次数，提高了效率。 边沿触发可以只读取缓存区中前面的部分信息，进而分析后面的信息是否有用，如果无用则直接丢弃。

## Libevent库了解多少

是一个开源的库，封装了socket和IO多路转接，用于高并发服务器的开发。跨平台可移植性好。

## reactor反应堆

## 线程池

## 协程

协程的开销远远小于线程的开销。 协程是一种比线程更加轻量级的存在，一个线程可以拥有多个协程。 无论是进程还是线程，都是由操作系统所管理的。而协程不是被OS所管理，而完全是由程序所控制(也就是在用户态执行)。

## 信号

## 线程同步

互斥量 读写锁 条件变量 信号量

## 死锁

## linux命令

file 查看文件类型 sudo iptables -L 查看防火墙状态

## 僵尸进程和孤儿进程

僵尸进程：子进程死亡，而父进程没有进行回收 孤儿进程：父进程死亡，而子进程仍然存活，但是系统会让init进程领养孤儿进程。

## fork函数

fork函数用来创建子进程 一次调用，两次返回。在父进程中返回子进程的PID，在子进程中返回0

## exec族

在程序中调用另一个可执行程序。但是进程ID不改变

## 网络编程IO

服务器通常需要处理三类事件：IO事件，信号及定时事件。

事件处理模式：reactor和proactor

同步IO模型通常用于实现reactor模式

异步IO则用于实现proactor模式

## 什么是reactor模式

它要求主线程只负责监听文件描述符上是否有事件发生，有的话立即将该事件通知工作线程。读写数据，接受新的连接以及处理客户请求均在工作线程中完成。

## 什么是proactor模式

它将所有IO操作都交给主线程和内核来处理，工作线程仅仅负责业务逻辑。

## Libevent

跨平台，线程安全，基于reactor模式实现的高效网络库。

