  

## 什么是索引

索引是数据表中对**字段**进行排序的一种**数据结构**。常用的索引由AVL树，B树，B+树，红黑树，哈希表。

哈希表和B树不利于范围查找。红黑树在数据量大的时候性能会下降。AVL树在数据有序时会退化成链表。

**聚集索引：**数据和索引在一起的。

**非聚集索引：**索引文件和数据文件是分离的。

联合索引：对多个字段同时建立的索引。Mysql从左到右的使用索引中的字段，一个查询可以只使用索引中的一部份，但只能是最左侧部分，**跳跃索引查询**就会导致索引失效。

## B树和B+树的区别

1.  B树：叶节点具有相同的深度，**所有索引元素不重复**，节点中的数据索引从左到右递增排列。
2.  B+树：**非叶子节点不存储数据，只存储索引**，叶子节点包含了全部的关键字且存储数据。叶子节点用指针连接从左往右递增排序，提高区间访问的性能。

## mysql存储引擎myISAM和InnoDB

**存储引擎是基于表的，而不是数据库。**

1.  InnoDB引擎：**支持事务，行锁**（适合高并发），支持外键。mysql5.5版本后的**默认存储引擎** 
2.  myISAM引擎：不支持事务，不支持外键，支持表锁。**优势是访问的速度快**。mysql5.5版本前的默认存储引擎。myISAM索引文件和数据文件是分离的。



## 数据库三大范式

1.  数据库中的**所有字段**都是**不可分割的原子值**
2.  满足第一范式的前提下，除主键外的**每一列**都必须**完全依赖于主键**。如果不完全依赖，只能发生在联合主键下。
3.  满足第二范式的前提下，除开主键列的其他**列之间**不能有**传递依赖**关系。



## 事务的四个特性ACID

事务是作为单个逻辑工作单元执行的一系列操作。要么完全执行，要么完全不执行。

1.  **原子性 ：**同一事务中多个操作不能分割，必须是一个整体。
2.  **一致性 ：**事务操作前后的总量保持一致。
3.  **隔离性 ：**多个事务之间的操作互不干扰。
4.  **持久性：**事务提交以后，对数据库中数据的改变是永久的。



## 事务隔离级别

事务分为四个隔离级别：分别是读未提交，读提交，可重复读，串行化。从前往后隔离级别依次递增，同时执行效率依次下降。

1.  **读未提交：**会产生脏读，即一个事务读取了另一个事务未提交的内容。
2.  **读提交：**可以解决脏读问题，但是会产生不可重复读，即一个事务在执行的过程中得到的结果不一致。
3.  **可重复读：**可以解决不可重复读的问题，但会产生幻读，即一个事务无法看到另一个事务已经提交的内容。
4.  **串行化：**可以解决幻读问题。当同一张表被另一个事务操作时，其他事务的写操作是不可以进行的，进入串行化排队，直到另一个结束，同时还为超时的情况下才可以继续执行。

```sql
set global transaction isolation level read committed # 修改隔离级别
select @@x_isolation  # 查看隔离级别
```



## 主键和外键约束

主键：**唯一且非空。**一个表有且只能由一个主键约束。创建主键会自动创建对应的索引，同样删除主键，对应的索引也会被删除。

外键约束：如果定义了外键约束，主表中没有的数据在子表中是**不可以被使用的**。主表中的记录被子表引用，是不可以被删除的。

## inner join 和 left join

1.  等值联接：inner join返回两个表中联接字段相等的行
2.  左联接：left join 返回左表所有记录和右表中联接字段相等的记录，如果左表中的记录在右边不存在，则对应字段设为null。

## redis

是C语言编写的基于**内存可持久化**的key-value内存数据库，使用的是**epoll单线程模型**。常用的数据结构有set， list，string, hash, sorted set。

## 查询

分组查询：count() sum() max() min() avg()

聚合查询：7种 A B A∪B A∩B   A - A∩B  B - A∩B  A∪B - A∩B



